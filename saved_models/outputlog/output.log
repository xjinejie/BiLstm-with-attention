nohup: ignoring input
从 config.yaml 读取配置。
Loading data from dataset/yelp_academic_dataset_review.json...
Loading data from dataset/test.json...
Vocab Size: 50002

================ 实验开始 ================

运行实验: [Baseline]

>>> Start Training: Residual=True, Drop=0.3, Depth=2, LN=True, LR_Decay=True
Epoch 1/15 | Train Loss: 1.0998 | Train Acc: 0.5123 | Val Loss: 1.0586 | Val Acc: 0.5619
Epoch 2/15 | Train Loss: 0.9424 | Train Acc: 0.5838 | Val Loss: 0.9392 | Val Acc: 0.5972
Epoch 3/15 | Train Loss: 0.8693 | Train Acc: 0.6143 | Val Loss: 0.8950 | Val Acc: 0.6178
Epoch 4/15 | Train Loss: 0.8236 | Train Acc: 0.6349 | Val Loss: 0.9219 | Val Acc: 0.6198
Epoch 5/15 | Train Loss: 0.7887 | Train Acc: 0.6515 | Val Loss: 0.8943 | Val Acc: 0.6266
Epoch 6/15 | Train Loss: 0.7577 | Train Acc: 0.6663 | Val Loss: 0.9254 | Val Acc: 0.6249
Epoch 7/15 | Train Loss: 0.7288 | Train Acc: 0.6803 | Val Loss: 0.9664 | Val Acc: 0.6253
Epoch 8/15 | Train Loss: 0.6822 | Train Acc: 0.7011 | Val Loss: 0.9694 | Val Acc: 0.6253
Epoch 9/15 | Train Loss: 0.6608 | Train Acc: 0.7118 | Val Loss: 0.9845 | Val Acc: 0.6283
Epoch 10/15 | Train Loss: 0.6305 | Train Acc: 0.7256 | Val Loss: 1.0541 | Val Acc: 0.6183
Epoch 11/15 | Train Loss: 0.6167 | Train Acc: 0.7322 | Val Loss: 1.0571 | Val Acc: 0.6244
Epoch 12/15 | Train Loss: 0.5996 | Train Acc: 0.7417 | Val Loss: 1.0861 | Val Acc: 0.6213
Epoch 13/15 | Train Loss: 0.5920 | Train Acc: 0.7445 | Val Loss: 1.1088 | Val Acc: 0.6176
Epoch 14/15 | Train Loss: 0.5826 | Train Acc: 0.7488 | Val Loss: 1.1302 | Val Acc: 0.6187
Epoch 15/15 | Train Loss: 0.5789 | Train Acc: 0.7508 | Val Loss: 1.1417 | Val Acc: 0.6172

-----------------------------------------------
Result [Baseline]: best val Top-1 Acc = 0.6283

运行实验: [dropout_0.5]

>>> Start Training: Residual=True, Drop=0.5, Depth=2, LN=True, LR_Decay=True
Epoch 1/15 | Train Loss: 1.1842 | Train Acc: 0.4750 | Val Loss: 1.1724 | Val Acc: 0.5526
Epoch 2/15 | Train Loss: 1.0023 | Train Acc: 0.5517 | Val Loss: 1.0685 | Val Acc: 0.5814
Epoch 3/15 | Train Loss: 0.9362 | Train Acc: 0.5816 | Val Loss: 1.0117 | Val Acc: 0.5980
Epoch 4/15 | Train Loss: 0.8970 | Train Acc: 0.5986 | Val Loss: 1.0031 | Val Acc: 0.6073
Epoch 5/15 | Train Loss: 0.8680 | Train Acc: 0.6141 | Val Loss: 0.9854 | Val Acc: 0.6150
Epoch 6/15 | Train Loss: 0.8422 | Train Acc: 0.6257 | Val Loss: 1.0450 | Val Acc: 0.6142
Epoch 7/15 | Train Loss: 0.8227 | Train Acc: 0.6353 | Val Loss: 1.0166 | Val Acc: 0.6225
Epoch 8/15 | Train Loss: 0.7934 | Train Acc: 0.6504 | Val Loss: 1.0221 | Val Acc: 0.6278
Epoch 9/15 | Train Loss: 0.7833 | Train Acc: 0.6540 | Val Loss: 1.0411 | Val Acc: 0.6258
Epoch 10/15 | Train Loss: 0.7666 | Train Acc: 0.6610 | Val Loss: 1.0330 | Val Acc: 0.6285
Epoch 11/15 | Train Loss: 0.7584 | Train Acc: 0.6643 | Val Loss: 1.0521 | Val Acc: 0.6314
Epoch 12/15 | Train Loss: 0.7522 | Train Acc: 0.6684 | Val Loss: 1.0754 | Val Acc: 0.6293
Epoch 13/15 | Train Loss: 0.7485 | Train Acc: 0.6705 | Val Loss: 1.0540 | Val Acc: 0.6307
Epoch 14/15 | Train Loss: 0.7450 | Train Acc: 0.6713 | Val Loss: 1.0604 | Val Acc: 0.6313
Epoch 15/15 | Train Loss: 0.7413 | Train Acc: 0.6733 | Val Loss: 1.0800 | Val Acc: 0.6314

-----------------------------------------------
Result [dropout_0.5]: best val Top-1 Acc = 0.6314

运行实验: [dropout_0]

>>> Start Training: Residual=True, Drop=0.0, Depth=2, LN=True, LR_Decay=True
Epoch 1/15 | Train Loss: 1.0336 | Train Acc: 0.5428 | Val Loss: 0.9392 | Val Acc: 0.5773
Epoch 2/15 | Train Loss: 0.8452 | Train Acc: 0.6252 | Val Loss: 0.8748 | Val Acc: 0.6082
Epoch 3/15 | Train Loss: 0.7572 | Train Acc: 0.6676 | Val Loss: 0.8833 | Val Acc: 0.6153
Epoch 4/15 | Train Loss: 0.6689 | Train Acc: 0.7100 | Val Loss: 0.9176 | Val Acc: 0.6122
Epoch 5/15 | Train Loss: 0.5086 | Train Acc: 0.7883 | Val Loss: 1.0332 | Val Acc: 0.6119
Epoch 6/15 | Train Loss: 0.3868 | Train Acc: 0.8465 | Val Loss: 1.2156 | Val Acc: 0.6032
Epoch 7/15 | Train Loss: 0.2272 | Train Acc: 0.9201 | Val Loss: 1.5518 | Val Acc: 0.5946
Epoch 8/15 | Train Loss: 0.1418 | Train Acc: 0.9555 | Val Loss: 1.9080 | Val Acc: 0.5922
Epoch 9/15 | Train Loss: 0.0762 | Train Acc: 0.9811 | Val Loss: 2.2133 | Val Acc: 0.5872
Epoch 10/15 | Train Loss: 0.0486 | Train Acc: 0.9897 | Val Loss: 2.5039 | Val Acc: 0.5798
Epoch 11/15 | Train Loss: 0.0314 | Train Acc: 0.9946 | Val Loss: 2.7066 | Val Acc: 0.5820
Epoch 12/15 | Train Loss: 0.0242 | Train Acc: 0.9961 | Val Loss: 2.8839 | Val Acc: 0.5813
Epoch 13/15 | Train Loss: 0.0187 | Train Acc: 0.9972 | Val Loss: 2.9951 | Val Acc: 0.5800
Epoch 14/15 | Train Loss: 0.0164 | Train Acc: 0.9976 | Val Loss: 3.0944 | Val Acc: 0.5800
Epoch 15/15 | Train Loss: 0.0141 | Train Acc: 0.9981 | Val Loss: 3.1640 | Val Acc: 0.5800

-----------------------------------------------
Result [dropout_0]: best val Top-1 Acc = 0.6153

运行实验: [no_layer_norm]

>>> Start Training: Residual=True, Drop=0.3, Depth=2, LN=False, LR_Decay=True
Epoch 1/15 | Train Loss: 1.1005 | Train Acc: 0.5122 | Val Loss: 1.0354 | Val Acc: 0.5435
Epoch 2/15 | Train Loss: 0.9315 | Train Acc: 0.5835 | Val Loss: 0.9248 | Val Acc: 0.5951
Epoch 3/15 | Train Loss: 0.8679 | Train Acc: 0.6138 | Val Loss: 0.8634 | Val Acc: 0.6184
Epoch 4/15 | Train Loss: 0.8233 | Train Acc: 0.6339 | Val Loss: 0.8741 | Val Acc: 0.6206
Epoch 5/15 | Train Loss: 0.7873 | Train Acc: 0.6513 | Val Loss: 0.8607 | Val Acc: 0.6265
Epoch 6/15 | Train Loss: 0.7552 | Train Acc: 0.6661 | Val Loss: 0.9118 | Val Acc: 0.6211
Epoch 7/15 | Train Loss: 0.7245 | Train Acc: 0.6807 | Val Loss: 0.9030 | Val Acc: 0.6265
Epoch 8/15 | Train Loss: 0.6759 | Train Acc: 0.7042 | Val Loss: 0.9250 | Val Acc: 0.6291
Epoch 9/15 | Train Loss: 0.6540 | Train Acc: 0.7151 | Val Loss: 0.9400 | Val Acc: 0.6290
Epoch 10/15 | Train Loss: 0.6199 | Train Acc: 0.7309 | Val Loss: 0.9913 | Val Acc: 0.6228
Epoch 11/15 | Train Loss: 0.6075 | Train Acc: 0.7367 | Val Loss: 0.9980 | Val Acc: 0.6253
Epoch 12/15 | Train Loss: 0.5878 | Train Acc: 0.7457 | Val Loss: 1.0043 | Val Acc: 0.6239
Epoch 13/15 | Train Loss: 0.5806 | Train Acc: 0.7498 | Val Loss: 1.0245 | Val Acc: 0.6223
Epoch 14/15 | Train Loss: 0.5720 | Train Acc: 0.7532 | Val Loss: 1.0433 | Val Acc: 0.6232
Epoch 15/15 | Train Loss: 0.5686 | Train Acc: 0.7552 | Val Loss: 1.0452 | Val Acc: 0.6231

-----------------------------------------------
Result [no_layer_norm]: best val Top-1 Acc = 0.6291

运行实验: [no_lr_decay]

>>> Start Training: Residual=True, Drop=0.3, Depth=2, LN=True, LR_Decay=False
Epoch 1/15 | Train Loss: 1.1098 | Train Acc: 0.5065 | Val Loss: 1.0615 | Val Acc: 0.5567
Epoch 2/15 | Train Loss: 0.9301 | Train Acc: 0.5833 | Val Loss: 0.9255 | Val Acc: 0.6009
Epoch 3/15 | Train Loss: 0.8670 | Train Acc: 0.6155 | Val Loss: 0.9149 | Val Acc: 0.6123
Epoch 4/15 | Train Loss: 0.8245 | Train Acc: 0.6343 | Val Loss: 0.9097 | Val Acc: 0.6215
Epoch 5/15 | Train Loss: 0.7843 | Train Acc: 0.6537 | Val Loss: 0.9057 | Val Acc: 0.6266
Epoch 6/15 | Train Loss: 0.7557 | Train Acc: 0.6669 | Val Loss: 0.9414 | Val Acc: 0.6217
Epoch 7/15 | Train Loss: 0.7242 | Train Acc: 0.6824 | Val Loss: 0.9862 | Val Acc: 0.6210
Epoch 8/15 | Train Loss: 0.6968 | Train Acc: 0.6941 | Val Loss: 0.9386 | Val Acc: 0.6266
Epoch 9/15 | Train Loss: 0.6722 | Train Acc: 0.7082 | Val Loss: 0.9684 | Val Acc: 0.6281
Epoch 10/15 | Train Loss: 0.6470 | Train Acc: 0.7192 | Val Loss: 1.0587 | Val Acc: 0.6095
Epoch 11/15 | Train Loss: 0.6205 | Train Acc: 0.7308 | Val Loss: 1.0509 | Val Acc: 0.6175
Epoch 12/15 | Train Loss: 0.5983 | Train Acc: 0.7426 | Val Loss: 1.0969 | Val Acc: 0.6168
Epoch 13/15 | Train Loss: 0.5774 | Train Acc: 0.7522 | Val Loss: 1.1329 | Val Acc: 0.6076
Epoch 14/15 | Train Loss: 0.5576 | Train Acc: 0.7623 | Val Loss: 1.1473 | Val Acc: 0.6119
Epoch 15/15 | Train Loss: 0.5383 | Train Acc: 0.7706 | Val Loss: 1.1309 | Val Acc: 0.6186

-----------------------------------------------
Result [no_lr_decay]: best val Top-1 Acc = 0.6281

运行实验: [no_residual]

>>> Start Training: Residual=False, Drop=0.3, Depth=2, LN=True, LR_Decay=True
Epoch 1/15 | Train Loss: 1.0755 | Train Acc: 0.5226 | Val Loss: 0.9652 | Val Acc: 0.5774
Epoch 2/15 | Train Loss: 0.9061 | Train Acc: 0.5987 | Val Loss: 0.8723 | Val Acc: 0.6125
Epoch 3/15 | Train Loss: 0.8443 | Train Acc: 0.6262 | Val Loss: 0.8532 | Val Acc: 0.6222
Epoch 4/15 | Train Loss: 0.8005 | Train Acc: 0.6468 | Val Loss: 0.8546 | Val Acc: 0.6303
Epoch 5/15 | Train Loss: 0.7653 | Train Acc: 0.6632 | Val Loss: 0.8567 | Val Acc: 0.6291
Epoch 6/15 | Train Loss: 0.7124 | Train Acc: 0.6879 | Val Loss: 0.8929 | Val Acc: 0.6269
Epoch 7/15 | Train Loss: 0.6880 | Train Acc: 0.6985 | Val Loss: 0.8832 | Val Acc: 0.6344
Epoch 8/15 | Train Loss: 0.6522 | Train Acc: 0.7163 | Val Loss: 0.8817 | Val Acc: 0.6371
Epoch 9/15 | Train Loss: 0.6390 | Train Acc: 0.7239 | Val Loss: 0.8875 | Val Acc: 0.6346
Epoch 10/15 | Train Loss: 0.6142 | Train Acc: 0.7354 | Val Loss: 0.9132 | Val Acc: 0.6327
Epoch 11/15 | Train Loss: 0.6065 | Train Acc: 0.7384 | Val Loss: 0.9186 | Val Acc: 0.6338
Epoch 12/15 | Train Loss: 0.5941 | Train Acc: 0.7437 | Val Loss: 0.9300 | Val Acc: 0.6331
Epoch 13/15 | Train Loss: 0.5899 | Train Acc: 0.7472 | Val Loss: 0.9368 | Val Acc: 0.6336
Epoch 14/15 | Train Loss: 0.5841 | Train Acc: 0.7488 | Val Loss: 0.9402 | Val Acc: 0.6324
Epoch 15/15 | Train Loss: 0.5806 | Train Acc: 0.7509 | Val Loss: 0.9430 | Val Acc: 0.6315

-----------------------------------------------
Result [no_residual]: best val Top-1 Acc = 0.6371

运行实验: [layers_1]

>>> Start Training: Residual=True, Drop=0.3, Depth=1, LN=True, LR_Decay=True
Epoch 1/15 | Train Loss: 1.1236 | Train Acc: 0.5030 | Val Loss: 0.9944 | Val Acc: 0.5627
Epoch 2/15 | Train Loss: 0.9439 | Train Acc: 0.5783 | Val Loss: 0.9225 | Val Acc: 0.5927
Epoch 3/15 | Train Loss: 0.8763 | Train Acc: 0.6097 | Val Loss: 0.8982 | Val Acc: 0.6064
Epoch 4/15 | Train Loss: 0.8304 | Train Acc: 0.6324 | Val Loss: 0.8863 | Val Acc: 0.6206
Epoch 5/15 | Train Loss: 0.7934 | Train Acc: 0.6491 | Val Loss: 0.8802 | Val Acc: 0.6249
Epoch 6/15 | Train Loss: 0.7580 | Train Acc: 0.6660 | Val Loss: 0.8993 | Val Acc: 0.6255
Epoch 7/15 | Train Loss: 0.7284 | Train Acc: 0.6800 | Val Loss: 0.9105 | Val Acc: 0.6239
Epoch 8/15 | Train Loss: 0.6813 | Train Acc: 0.7031 | Val Loss: 0.9371 | Val Acc: 0.6261
Epoch 9/15 | Train Loss: 0.6597 | Train Acc: 0.7126 | Val Loss: 0.9654 | Val Acc: 0.6236
Epoch 10/15 | Train Loss: 0.6274 | Train Acc: 0.7280 | Val Loss: 0.9867 | Val Acc: 0.6246
Epoch 11/15 | Train Loss: 0.6177 | Train Acc: 0.7335 | Val Loss: 1.0060 | Val Acc: 0.6210
Epoch 12/15 | Train Loss: 0.6005 | Train Acc: 0.7413 | Val Loss: 1.0156 | Val Acc: 0.6236
Epoch 13/15 | Train Loss: 0.5949 | Train Acc: 0.7443 | Val Loss: 1.0167 | Val Acc: 0.6216
Epoch 14/15 | Train Loss: 0.5847 | Train Acc: 0.7489 | Val Loss: 1.0298 | Val Acc: 0.6221
Epoch 15/15 | Train Loss: 0.5825 | Train Acc: 0.7490 | Val Loss: 1.0449 | Val Acc: 0.6210

-----------------------------------------------
Result [layers_1]: best val Top-1 Acc = 0.6261

运行实验: [layers_3]

>>> Start Training: Residual=True, Drop=0.3, Depth=3, LN=True, LR_Decay=True
Epoch 1/15 | Train Loss: 1.1165 | Train Acc: 0.5023 | Val Loss: 1.0738 | Val Acc: 0.5576
Epoch 2/15 | Train Loss: 0.9305 | Train Acc: 0.5841 | Val Loss: 0.9712 | Val Acc: 0.5976
Epoch 3/15 | Train Loss: 0.8646 | Train Acc: 0.6156 | Val Loss: 0.9228 | Val Acc: 0.6202
Epoch 4/15 | Train Loss: 0.8179 | Train Acc: 0.6368 | Val Loss: 0.9368 | Val Acc: 0.6216
Epoch 5/15 | Train Loss: 0.8339 | Train Acc: 0.6408 | Val Loss: 0.9283 | Val Acc: 0.6117
Epoch 6/15 | Train Loss: 0.7686 | Train Acc: 0.6617 | Val Loss: 0.9663 | Val Acc: 0.6240
Epoch 7/15 | Train Loss: 0.7308 | Train Acc: 0.6803 | Val Loss: 0.9515 | Val Acc: 0.6294
Epoch 8/15 | Train Loss: 0.6975 | Train Acc: 0.6958 | Val Loss: 0.9773 | Val Acc: 0.6293
Epoch 9/15 | Train Loss: 0.6834 | Train Acc: 0.7017 | Val Loss: 0.9758 | Val Acc: 0.6307
Epoch 10/15 | Train Loss: 0.6643 | Train Acc: 0.7113 | Val Loss: 1.0025 | Val Acc: 0.6300
Epoch 11/15 | Train Loss: 0.6584 | Train Acc: 0.7146 | Val Loss: 1.0009 | Val Acc: 0.6303
Epoch 12/15 | Train Loss: 0.6465 | Train Acc: 0.7188 | Val Loss: 1.0028 | Val Acc: 0.6303
Epoch 13/15 | Train Loss: 0.6429 | Train Acc: 0.7219 | Val Loss: 1.0102 | Val Acc: 0.6320
Epoch 14/15 | Train Loss: 0.6392 | Train Acc: 0.7229 | Val Loss: 1.0088 | Val Acc: 0.6289
Epoch 15/15 | Train Loss: 0.6372 | Train Acc: 0.7247 | Val Loss: 1.0260 | Val Acc: 0.6297

-----------------------------------------------
Result [layers_3]: best val Top-1 Acc = 0.6320

================ 最终总结 ================
实验名称                 | 最佳验证准确率
----------------------------------------
Baseline             | 0.6283
dropout_0.5          | 0.6314
dropout_0            | 0.6153
no_layer_norm        | 0.6291
no_lr_decay          | 0.6281
no_residual          | 0.6371
layers_1             | 0.6261
layers_3             | 0.6320
----------------------------------------
Best Configuration: no_residual with val_Acc: 0.6371

Evaluating Best Model (no_residual) on Test Set...
Test Accuracy: 0.7970
